This tests makes sure that opam file generation on Windows does not introduce
carriage return characters. These are usually removed by git when a file is
added to version control however Dune still registers a difference and
auto-promotes the file.

Specifically we test the case where the opam file is generated from a template
file.

  $ cat > dune-project << EOF
  > (lang dune 3.12)
  > (generate_opam_files true)
  > (package
  >  (name foo)
  >  (allow_empty))
  > EOF

  $ cat > foo.opam << 'EOF'
  > # This file is generated by dune, edit dune-project instead
  > opam-version: "2.0"
  > depends: [
  >   "dune" {>= "3.12"}
  >   "odoc" {with-doc}
  > ]
  > build: [
  >   ["dune" "subst"] {dev}
  >   [
  >     "dune"
  >     "build"
  >     "-p"
  >     name
  >     "-j"
  >     jobs
  >     "@install"
  >     "@runtest" {with-test}
  >     "@doc" {with-doc}
  >   ]
  > ]
  > EOF

  $ cat > foo.opam.template

Copy the original opam file for later comparison.

  $ cp foo.opam.template foo.opam.old

Build the opam file, which may cause regeneration.

  $ dune build foo.opam

Check for any differences.

  $ diff -q foo.opam foo.opam.old 
  Files foo.opam and foo.opam.old differ
  [1]
 
